<!doctype html>
<title>Tasks</title>
<h1>Add Task</h1>
<form action="{{ url_for('create_task') }}" method="post">
  <label>Title: <input name="title" required></label><br>
  <label>Description:<br>
    <textarea name="description" rows="3" cols="40"></textarea>
  </label><br>
  <label>Due date: <input type="date" name="due_date" required></label><br>
  <label>Duration (days): <input type="number" name="duration_days" step="0.5" value="1"></label><br>
  <label>Importance (0–10): <input type="number" name="importance" min="0" max="10" value="5"></label><br>
  <button type="submit">Add</button>
</form>

<hr>
<h2>Tasks (by start date)</h2>
<ol>
  {% for t in tasks %}
    <li>
      <strong>{% if t.completed %}<s>{{ t.title }}</s>{% else %}{{ t.title }}{% endif %}</strong>
      — start {{ t.start_date }}, due {{ t.due_date }}, dur {{ t.duration_days }}, priority {{ t.importance }}
      {% if t.description %}<div>{{ t.description }}</div>{% endif %}

      <!-- actions -->
      {% if not t.completed %}
        <form action="{{ url_for('complete_task', task_id=t.id) }}" method="post" style="display:inline">
          <button type="submit">Complete</button>
        </form>
      {% else %}
        <form action="{{ url_for('uncomplete_task', task_id=t.id) }}" method="post" style="display:inline">
          <button type="submit">Uncomplete</button>
        </form>
      {% endif %}
      <form action="{{ url_for('delete_task', task_id=t.id) }}" method="post" style="display:inline" onsubmit="return confirm('Delete this task?');">
        <button type="submit">Delete</button>
      </form>

      <!-- inline edit -->
      <details>
        <summary>Edit</summary>
        <form action="{{ url_for('edit_task', task_id=t.id) }}" method="post">
          <label>Title <input name="title" value="{{ t.title }}" required></label><br>
          <label>Due <input type="date" name="due_date" value="{{ t.due_date }}" required></label><br>
          <label>Duration <input type="number" step="0.5" name="duration_days" value="{{ t.duration_days }}"></label><br>
          <label>Priority <input type="number" min="0" max="10" name="importance" value="{{ t.importance }}"></label><br>
          <label>Description<br><textarea name="description" rows="3" cols="40">{{ t.description }}</textarea></label><br>
          <button type="submit">Save</button>
        </form>
      </details>
      <hr>
    </li>
  {% else %}
    <p>No tasks yet.</p>
  {% endfor %}
</ol>
